<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>JobOpeningController.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">HR Management</a> &gt; <a href="index.source.html" class="el_package">com.atomicnorth.hrm.tenant.web.rest.jobOpening</a> &gt; <span class="el_source">JobOpeningController.java</span></div><h1>JobOpeningController.java</h1><pre class="source lang-java linenums">package com.atomicnorth.hrm.tenant.web.rest.jobOpening;

import com.atomicnorth.hrm.exception.ResourceNotFoundException;
import com.atomicnorth.hrm.tenant.domain.jobOpening.*;
import com.atomicnorth.hrm.tenant.repository.jobOpening.JobOfferRepository;
import com.atomicnorth.hrm.tenant.service.dto.jobOpening.*;
import com.atomicnorth.hrm.tenant.service.jobOpening.JobOpeningService;
import com.atomicnorth.hrm.tenant.service.jobOpening.JobRequisitionService;
import com.atomicnorth.hrm.tenant.service.jobOpening.StaffPlanService;
import com.atomicnorth.hrm.util.commonClass.ApiResponse;
import com.fasterxml.jackson.databind.ObjectMapper;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.data.domain.PageRequest;
import org.springframework.data.domain.Pageable;
import org.springframework.data.domain.Sort;
import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;
import org.springframework.validation.annotation.Validated;
import org.springframework.web.bind.annotation.*;

import javax.persistence.EntityNotFoundException;
import javax.validation.Valid;
import javax.validation.ValidationException;
import java.text.ParseException;
import java.util.Collections;
import java.util.List;
import java.util.Map;
import java.util.Optional;

@RestController
@RequestMapping(&quot;/api/jobOpening&quot;)
public class JobOpeningController {

<span class="nc" id="L36">    private final Logger log = LoggerFactory.getLogger(JobOpeningController.class);</span>


    private final JobOpeningService jobOpeningService;

    @Autowired
    private StaffPlanService staffPlanService;
    @Autowired
    private JobOfferRepository jobOfferRepository;
    @Autowired
    private ObjectMapper objectMapper;

    @Autowired
    private JobRequisitionService jobRequisitionService;

<span class="nc" id="L51">    public JobOpeningController(JobOpeningService jobOpeningService) {</span>
<span class="nc" id="L52">        this.jobOpeningService = jobOpeningService;</span>
<span class="nc" id="L53">    }</span>

    @PostMapping(&quot;/create&quot;)
    public ResponseEntity&lt;ApiResponse&lt;JobOpening&gt;&gt; saveOrUpdateJobOpening(
            @Valid @RequestBody JobOpeningDTO jobOpeningDTO) {
        try {
<span class="nc bnc" id="L59" title="All 2 branches missed.">            if (jobOpeningDTO.getUpperRange() &lt; jobOpeningDTO.getLowerRange()) {</span>
<span class="nc" id="L60">                return ResponseEntity.status(HttpStatus.OK).body(new ApiResponse&lt;&gt;(null, false, &quot;JOB-OPENING-VALIDATION-FAILURE&quot;, &quot;Error&quot;, Collections.singletonList(&quot;Upper range cannot be smaller than lower range&quot;)));</span>
            }
<span class="nc" id="L62">            JobOpening opening = jobOpeningService.saveOrUpdateJobOpening(jobOpeningDTO);</span>
<span class="nc bnc" id="L63" title="All 2 branches missed.">            String message = (jobOpeningDTO.getJobOpeningId() != null)</span>
<span class="nc" id="L64">                    ? &quot;JOB-OPENING-UPDATED-SUCCESS&quot;</span>
<span class="nc" id="L65">                    : &quot;JOB-OPENING-CREATED-SUCCESS&quot;;</span>

<span class="nc" id="L67">            ApiResponse&lt;JobOpening&gt; response = new ApiResponse&lt;&gt;(</span>
                    opening,
                    true,
                    message,
                    &quot;Information&quot;
            );
<span class="nc" id="L73">            return ResponseEntity.status(HttpStatus.OK).body(response);</span>
<span class="nc" id="L74">        } catch (ValidationException e) {</span>
<span class="nc" id="L75">            ApiResponse&lt;JobOpening&gt; validationErrorResponse = new ApiResponse&lt;&gt;(</span>
                    null,
                    false,
                    &quot;JOB-OPENING-VALIDATION-FAILURE&quot;,
                    &quot;Error&quot;,
<span class="nc" id="L80">                    Collections.singletonList(e.getMessage())</span>
            );
<span class="nc" id="L82">            return ResponseEntity.status(HttpStatus.OK).body(validationErrorResponse);</span>
<span class="nc" id="L83">        } catch (Exception e) {</span>
<span class="nc" id="L84">            ApiResponse&lt;JobOpening&gt; errorResponse = new ApiResponse&lt;&gt;(</span>
                    null,
                    false,
                    &quot;JOB-OPENING-CREATION-FAILURE&quot;,
                    &quot;Error&quot;,
<span class="nc" id="L89">                    Collections.singletonList(e.getMessage())</span>
            );
<span class="nc" id="L91">            return ResponseEntity.status(HttpStatus.OK).body(errorResponse);</span>
        }
    }

    @GetMapping(&quot;/{jobOpeningId}&quot;)
    public ResponseEntity&lt;ApiResponse&lt;JobOpeningDTO&gt;&gt; getJobOpeningById(@PathVariable(&quot;jobOpeningId&quot;) Integer jobOpeningId) {
        try {
            // Fetch designation details
<span class="nc" id="L99">            JobOpeningDTO dto = jobOpeningService.getJobOpeningById(jobOpeningId);</span>
            // Create success response
<span class="nc" id="L101">            ApiResponse&lt;JobOpeningDTO&gt; response = new ApiResponse&lt;&gt;(dto, true, &quot;JOB-OPENING-DATA-RETRIEVE-SUCCESS&quot;, &quot;Information&quot;</span>
            );
<span class="nc" id="L103">            return ResponseEntity.status(HttpStatus.OK).body(response);</span>
<span class="nc" id="L104">        } catch (EntityNotFoundException e) {</span>
            // Create not found error response
<span class="nc" id="L106">            ApiResponse&lt;JobOpeningDTO&gt; errorResponse = new ApiResponse&lt;&gt;(null, false, &quot;JOB-OPENING-DATA-RETRIEVE-FAILURE&quot;, &quot;Error&quot;</span>
            );
<span class="nc" id="L108">            return ResponseEntity.status(HttpStatus.OK).body(errorResponse);</span>
<span class="nc" id="L109">        } catch (Exception e) {</span>
            // Create internal server error response
<span class="nc" id="L111">            ApiResponse&lt;JobOpeningDTO&gt; errorResponse = new ApiResponse&lt;&gt;(null, false, &quot;JOB-OPENING-DATA-RETRIEVE-FAILURE&quot;, &quot;Error&quot;, Collections.singletonList(e.getMessage())</span>
            );
<span class="nc" id="L113">            return ResponseEntity.status(HttpStatus.OK).body(errorResponse);</span>
        }
    }

    @GetMapping(&quot;/all&quot;)
    public ResponseEntity&lt;ApiResponse&lt;Map&lt;String, Object&gt;&gt;&gt; getAllJobOpening(
            @RequestParam(defaultValue = &quot;1&quot;) int page,
            @RequestParam(defaultValue = &quot;10&quot;) int size,
            @RequestParam(value = &quot;sortBy&quot;, defaultValue = &quot;creationDate&quot;, required = false) String sortBy,
            @RequestParam(value = &quot;sortDir&quot;, defaultValue = &quot;desc&quot;, required = false) String sortDir,
            @RequestParam(value = &quot;searchKeyword&quot;, required = false) String searchKeyword,
            @RequestParam(value = &quot;searchField&quot;, required = false) String searchField
    ) {
        try {
<span class="nc bnc" id="L127" title="All 2 branches missed.">            if (&quot;designationName&quot;.equalsIgnoreCase(sortBy)) sortBy = &quot;designationId&quot;;</span>
<span class="nc bnc" id="L128" title="All 2 branches missed.">            if (&quot;departmentName&quot;.equalsIgnoreCase(sortBy)) sortBy = &quot;departmentId&quot;;</span>
<span class="nc" id="L129">            Pageable pageable = PageRequest.of(page - 1, size, Sort.Direction.fromString(sortDir), sortBy);</span>
<span class="nc" id="L130">            Map&lt;String, Object&gt; allJobOpening = jobOpeningService.getPaginatedJobOpenings(pageable, searchField, searchKeyword);</span>


<span class="nc" id="L133">            ApiResponse&lt;Map&lt;String, Object&gt;&gt; response = new ApiResponse&lt;&gt;(</span>
                    allJobOpening,
                    true,
                    &quot;JOB-OPENING-DATA-RETRIEVE-SUCCESS&quot;,
                    &quot;Information&quot;
            );
<span class="nc" id="L139">            return ResponseEntity.ok(response);</span>
<span class="nc" id="L140">        } catch (Exception e) {</span>
            // Return error response
<span class="nc" id="L142">            ApiResponse&lt;Map&lt;String, Object&gt;&gt; errorResponse = new ApiResponse&lt;&gt;(</span>
                    null,
                    false,
                    &quot;JOB-OPENING-DATA-RETRIEVE-FAILURE&quot;,
                    &quot;Error&quot;,
<span class="nc" id="L147">                    Collections.singletonList(e.getMessage())</span>
            );
<span class="nc" id="L149">            return ResponseEntity.status(HttpStatus.OK).body(errorResponse);</span>
        }
    }

    @DeleteMapping(&quot;/delete/{jobOpeningId}&quot;)
    public ResponseEntity&lt;ApiResponse&lt;String&gt;&gt; softDeleteJobOpening(@PathVariable Integer jobOpeningId) {
        try {
            // Call service to perform soft delete
<span class="nc" id="L157">            jobOpeningService.softDeleteJobOpening(jobOpeningId);</span>

            // Create success response
<span class="nc" id="L160">            ApiResponse&lt;String&gt; response = new ApiResponse&lt;&gt;(</span>
                    &quot;Job Opening with ID &quot; + jobOpeningId + &quot; has been deleted successfully.&quot;,
                    true,
                    &quot;JOB-DELETE-SUCCESS&quot;,
                    &quot;Information&quot;
            );
<span class="nc" id="L166">            return ResponseEntity.status(HttpStatus.OK).body(response);</span>
<span class="nc" id="L167">        } catch (ResourceNotFoundException ex) { // Use a custom exception like ResourceNotFoundException</span>
            // Create not found error response
<span class="nc" id="L169">            ApiResponse&lt;String&gt; errorResponse = new ApiResponse&lt;&gt;(</span>
<span class="nc" id="L170">                    ex.getMessage(),</span>
                    false,
                    &quot;JOB-DELETE-FAILURE&quot;,
                    &quot;Error&quot;
            );
<span class="nc" id="L175">            return ResponseEntity.status(HttpStatus.OK).body(errorResponse);</span>
<span class="nc" id="L176">        } catch (Exception ex) {</span>
            // Create internal server error response
<span class="nc" id="L178">            ApiResponse&lt;String&gt; errorResponse = new ApiResponse&lt;&gt;(</span>
                    &quot;An unexpected error occurred while deleting the job opening.&quot;,
                    false,
                    &quot;JOB-DELETE-FAILURE&quot;,
                    &quot;Error&quot;,
<span class="nc" id="L183">                    Collections.singletonList(ex.getMessage())</span>
            );
<span class="nc" id="L185">            return ResponseEntity.status(HttpStatus.OK).body(errorResponse);</span>
        }
    }

    @PostMapping(&quot;/createAndUpdate&quot;)
    public ResponseEntity&lt;ApiResponse&lt;JobOfferDTO&gt;&gt; saveOrUpdateJobOffer(
            @Valid @RequestBody JobOfferDTO jobOfferDTO) {
        try {
<span class="nc bnc" id="L193" title="All 2 branches missed.">            if (jobOfferDTO.getJobOfferId() == null) {</span>
//                Optional&lt;JobOffer&gt; existingDesignation = jobOfferRepository.findByDesignationId(jobOfferDTO.getDesignationId());
//                if (existingDesignation.isPresent()) {
//                    return new ResponseEntity&lt;&gt;(new ApiResponse&lt;&gt;(null, false, &quot;ATMCMN_DESIGNATION_EXISTS&quot;, &quot;FAILURE&quot;,
//                            Collections.singletonList(&quot;Designation Id already exist.&quot;)),
//                            HttpStatus.OK);
//                }
<span class="nc" id="L200">                Optional&lt;JobOffer&gt; existingJobApplicant = jobOfferRepository.findByJobApplicantId(jobOfferDTO.getJobApplicantId());</span>
<span class="nc bnc" id="L201" title="All 2 branches missed.">                if (existingJobApplicant.isPresent()) {</span>
<span class="nc" id="L202">                    return new ResponseEntity&lt;&gt;(new ApiResponse&lt;&gt;(null, false, &quot;ATMCMN_JOBAPPLICANT_EXISTS&quot;, &quot;FAILURE&quot;,</span>
<span class="nc" id="L203">                            Collections.singletonList(&quot;JobApplicant Id already exist.&quot;)),</span>
                            HttpStatus.OK);
                }
//                Optional&lt;JobOffer&gt; existingTermsAndConditionId = jobOfferRepository.findByTermsConditionId(jobOfferDTO.getTermsConditionId());
//                if (existingTermsAndConditionId.isPresent()) {
//                    return new ResponseEntity&lt;&gt;(new ApiResponse&lt;&gt;(null, false, &quot;ATMCMN_TERMS_AND_CONDITION_EXISTS&quot;, &quot;FAILURE&quot;,
//                            Collections.singletonList(&quot;TermsAndCondition Id already exist.&quot;)),
//                            HttpStatus.OK);
//                }
            }
<span class="nc" id="L213">            JobOfferDTO jobOffer = jobOpeningService.saveOrUpdateJobOffer(jobOfferDTO);</span>
<span class="nc bnc" id="L214" title="All 2 branches missed.">            String message = (jobOfferDTO.getJobOfferId() != null)</span>
<span class="nc" id="L215">                    ? &quot;JOB-OFFER-UPDATED-SUCCESS&quot;</span>
<span class="nc" id="L216">                    : &quot;JOB-OFFER-CREATED-SUCCESS&quot;;</span>
<span class="nc" id="L217">            ApiResponse&lt;JobOfferDTO&gt; response = new ApiResponse&lt;&gt;(</span>
                    jobOffer,
                    true,
                    message,
                    &quot;Information&quot;
            );
<span class="nc" id="L223">            return ResponseEntity.status(HttpStatus.OK).body(response);</span>
<span class="nc" id="L224">        } catch (ValidationException e) {</span>
<span class="nc" id="L225">            ApiResponse&lt;JobOfferDTO&gt; validationErrorResponse = new ApiResponse&lt;&gt;(</span>
                    null,
                    false,
                    &quot;JOB-OFFER-VALIDATION-FAILURE&quot;,
                    &quot;Error&quot;,
<span class="nc" id="L230">                    Collections.singletonList(e.getMessage())</span>
            );
<span class="nc" id="L232">            return ResponseEntity.status(HttpStatus.OK).body(validationErrorResponse);</span>

<span class="nc" id="L234">        } catch (Exception e) {</span>
<span class="nc" id="L235">            ApiResponse&lt;JobOfferDTO&gt; errorResponse = new ApiResponse&lt;&gt;(</span>
                    null,
                    false,
                    &quot;JOB-OFFER-CREATION-FAILURE&quot;,
                    &quot;Error&quot;,
<span class="nc" id="L240">                    Collections.singletonList(e.getMessage())</span>
            );
<span class="nc" id="L242">            return ResponseEntity.status(HttpStatus.OK).body(errorResponse);</span>
        }
    }

    @GetMapping(&quot;/findAll&quot;)
    public ResponseEntity&lt;ApiResponse&lt;Map&lt;String, Object&gt;&gt;&gt; getAllJobOffers(
            @RequestParam(value = &quot;page&quot;, defaultValue = &quot;1&quot;) int page,
            @RequestParam(value = &quot;size&quot;, defaultValue = &quot;10&quot;) int size,
            @RequestParam(value = &quot;sortBy&quot;, defaultValue = &quot;jobOfferId&quot;, required = false) String sortBy,
            @RequestParam(value = &quot;sortDir&quot;, defaultValue = &quot;desc&quot;) String sortDir,
            @RequestParam(value = &quot;searchField&quot;, required = false) String searchField,
            @RequestParam(value = &quot;searchKeyword&quot;, required = false) String searchKeyword) {

<span class="nc" id="L255">        log.debug(&quot;REST request to get paginated Job Offer Separations record&quot;);</span>
        try {
<span class="nc" id="L257">            Pageable pageable = PageRequest.of(page - 1, size, Sort.Direction.fromString(sortDir), sortBy);</span>
<span class="nc" id="L258">            Map&lt;String, Object&gt; allJobOffers = jobOpeningService.getPaginatedJobOffers(pageable, searchField, searchKeyword);</span>


<span class="nc" id="L261">            ApiResponse&lt;Map&lt;String, Object&gt;&gt; response = new ApiResponse&lt;&gt;(</span>
                    allJobOffers,
                    true,
                    &quot;JOB-OFFER-DATA-RETRIEVE-SUCCESS&quot;,
                    &quot;Information&quot;
            );
<span class="nc" id="L267">            return ResponseEntity.ok(response);</span>
<span class="nc" id="L268">        } catch (Exception e) {</span>
<span class="nc" id="L269">            ApiResponse&lt;Map&lt;String, Object&gt;&gt; errorResponse = new ApiResponse&lt;&gt;(</span>
                    null,
                    false,
                    &quot;JOB-OFFER-DATA-RETRIEVE-FAILURE&quot;,
                    &quot;Error&quot;,
<span class="nc" id="L274">                    Collections.singletonList(e.getMessage())</span>
            );
<span class="nc" id="L276">            return ResponseEntity.status(HttpStatus.OK).body(errorResponse);</span>
        }
    }

    @GetMapping
    public ResponseEntity&lt;ApiResponse&lt;JobOfferDTO&gt;&gt; getJobOfferById(@RequestParam(&quot;jobOfferId&quot;) Integer jobOfferId) {
        try {
<span class="nc" id="L283">            JobOfferDTO jobOfferDTO = jobOpeningService.getJobOfferById(jobOfferId);</span>

<span class="nc bnc" id="L285" title="All 2 branches missed.">            if (jobOfferDTO == null) {</span>
<span class="nc" id="L286">                ApiResponse&lt;JobOfferDTO&gt; response = new ApiResponse&lt;&gt;(</span>
                        null,
                        false,
                        &quot;JOB-OFFER-NOT-FOUND&quot;,
                        &quot;Error&quot;,
<span class="nc" id="L291">                        Collections.singletonList(&quot;Job Offer with ID &quot; + jobOfferId + &quot; not found.&quot;)</span>
                );
<span class="nc" id="L293">                return ResponseEntity.status(HttpStatus.OK).body(response);</span>
            }
<span class="nc" id="L295">            ApiResponse&lt;JobOfferDTO&gt; response = new ApiResponse&lt;&gt;(</span>
                    jobOfferDTO,
                    true,
                    &quot;JOB-OFFER-DATA-RETRIEVE-SUCCESS&quot;,
                    &quot;Information&quot;
            );
<span class="nc" id="L301">            return ResponseEntity.ok(response);</span>
<span class="nc" id="L302">        } catch (Exception e) {</span>
            // Return error response
<span class="nc" id="L304">            ApiResponse&lt;JobOfferDTO&gt; errorResponse = new ApiResponse&lt;&gt;(</span>
                    null,
                    false,
                    &quot;JOB-OFFER-DATA-RETRIEVE-FAILURE&quot;,
                    &quot;Error&quot;,
<span class="nc" id="L309">                    Collections.singletonList(e.getMessage())</span>
            );
<span class="nc" id="L311">            return ResponseEntity.status(HttpStatus.OK).body(errorResponse);</span>
        }
    }

    @DeleteMapping
    public ResponseEntity&lt;ApiResponse&lt;Void&gt;&gt; softDeleteJobOffer(@RequestParam(&quot;jobOfferId&quot;) Integer jobOfferId) {
        try {
<span class="nc" id="L318">            jobOpeningService.softDeleteJobOffer(jobOfferId);</span>
<span class="nc" id="L319">            return ResponseEntity.ok(new ApiResponse&lt;&gt;(null, true, &quot;JOB-OFFER-SOFT-DELETED&quot;, &quot;Job offer successfully marked as deleted&quot;));</span>
<span class="nc" id="L320">        } catch (EntityNotFoundException e) {</span>
<span class="nc" id="L321">            return ResponseEntity.status(HttpStatus.OK).body(</span>
<span class="nc" id="L322">                    new ApiResponse&lt;&gt;(null, false, &quot;JOB-OFFER-NOT-FOUND&quot;, e.getMessage())</span>
            );
<span class="nc" id="L324">        } catch (Exception e) {</span>
<span class="nc" id="L325">            return ResponseEntity.status(HttpStatus.OK).body(</span>
<span class="nc" id="L326">                    new ApiResponse&lt;&gt;(null, false, &quot;JOB-OFFER-SOFT-DELETE-FAILED&quot;, e.getMessage())</span>
            );
        }
    }

    @PostMapping(&quot;staff/saveOrUpdate&quot;)
    public ResponseEntity&lt;ApiResponse&lt;StaffPlanDTO&gt;&gt; saveOrUpdateStaffPlan(@Valid @RequestBody StaffPlanDTO request) throws ParseException {
        try {
<span class="nc" id="L334">            StaffPlanDTO savedDepartment = staffPlanService.createUpdateStaffPlan(request);</span>

<span class="nc" id="L336">            return new ResponseEntity&lt;&gt;(</span>
                    new ApiResponse&lt;&gt;(savedDepartment, true, &quot;STAFF_PLAN_CREATED&quot;, &quot;SUCCESS&quot;),
                    HttpStatus.OK);
<span class="nc" id="L339">        } catch (Exception e) {</span>
<span class="nc" id="L340">            log.error(&quot;Error occurred while creating Department&quot;, e);</span>
<span class="nc" id="L341">            return new ResponseEntity&lt;&gt;(</span>
                    new ApiResponse&lt;&gt;(null, false, &quot;STAFF_PLAN_CREATE_ERROR&quot;, &quot;ERROR&quot;,
<span class="nc" id="L343">                            Collections.singletonList(e.getMessage())),</span>
                    HttpStatus.OK);
        }
    }

    @GetMapping(&quot;staff/findAll&quot;)
    public ResponseEntity&lt;ApiResponse&lt;Map&lt;String, Object&gt;&gt;&gt; getAllStaffplan(
            @RequestParam(defaultValue = &quot;0&quot;) int page,
            @RequestParam(defaultValue = &quot;10&quot;) int size,
            @RequestParam(value = &quot;sortBy&quot;, defaultValue = &quot;createdDate&quot;, required = false) String sortBy,
            @RequestParam(value = &quot;sortDir&quot;, defaultValue = &quot;desc&quot;, required = false) String sortDir,
            @RequestParam(value = &quot;searchColumn&quot;, required = false) String searchColumn,
            @RequestParam(value = &quot;searchValue&quot;, required = false) String searchValue
    ) {
        try {
<span class="nc" id="L358">            Pageable pageable = PageRequest.of(page - 1, size, Sort.Direction.fromString(sortDir), sortBy);</span>
<span class="nc" id="L359">            Map&lt;String, Object&gt; departments = staffPlanService.findAllStaffPlan(pageable, searchColumn, searchValue);</span>
<span class="nc" id="L360">            ApiResponse&lt;Map&lt;String, Object&gt;&gt; response = new ApiResponse&lt;&gt;(</span>
                    departments,
                    true,
                    &quot;STAFF-LIST-SUCCESS&quot;,
                    &quot;Success&quot;
            );
<span class="nc" id="L366">            return ResponseEntity.status(HttpStatus.OK).body(response);</span>
<span class="nc" id="L367">        } catch (Exception e) {</span>
<span class="nc" id="L368">            log.error(&quot;Error occurred while fetching Departments&quot;, e);</span>
<span class="nc" id="L369">            return new ResponseEntity&lt;&gt;(</span>
                    new ApiResponse&lt;&gt;(null, false, &quot;ATMCMN-DEPARTMENT_FETCH_ERROR&quot;, &quot;FAILURE&quot;,
<span class="nc" id="L371">                            Collections.singletonList(e.getMessage())),</span>
                    HttpStatus.INTERNAL_SERVER_ERROR);
        }
    }

    @GetMapping(&quot;staff/{id}&quot;)
    public ResponseEntity&lt;ApiResponse&lt;StaffPlanDTO&gt;&gt; getStaffplanById(@PathVariable Long id) {
        try {
<span class="nc" id="L379">            return staffPlanService.getStaffPlanById(id)</span>
<span class="nc" id="L380">                    .map(dept -&gt; ResponseEntity.ok(new ApiResponse&lt;&gt;(dept, true, &quot;ATMCMN-DEPARTMENT_FETCHED&quot;, &quot;SUCCESS&quot;)))</span>
<span class="nc" id="L381">                    .orElse(new ResponseEntity&lt;&gt;(</span>
                            new ApiResponse&lt;&gt;(null, false, &quot;ATMCMN-DEPARTMENT_NOT_FOUND&quot;, &quot;FAILURE&quot;,
<span class="nc" id="L383">                                    Collections.singletonList(&quot;Department not found with ID: &quot; + id)),</span>
                            HttpStatus.NOT_FOUND));
<span class="nc" id="L385">        } catch (Exception e) {</span>
<span class="nc" id="L386">            log.error(&quot;Error occurred while fetching Department by ID&quot;, e);</span>
<span class="nc" id="L387">            return new ResponseEntity&lt;&gt;(</span>
                    new ApiResponse&lt;&gt;(null, false, &quot;ATMCMN-DEPARTMENT_FETCH_ERROR&quot;, &quot;FAILURE&quot;,
<span class="nc" id="L389">                            Collections.singletonList(e.getMessage())),</span>
                    HttpStatus.INTERNAL_SERVER_ERROR);
        }
    }

    @PostMapping(&quot;/createAndUpdateOfferTermMaster&quot;)
    public ResponseEntity&lt;ApiResponse&lt;OfferTermMaster&gt;&gt; saveAndUpdate(@Valid @RequestBody OfferTermMasterDTO termMasterDTO) {
<span class="nc" id="L396">        log.info(&quot;Received DTO: {}&quot;, termMasterDTO);</span>
        try {
<span class="nc" id="L398">            OfferTermMaster offerTermMaster = jobOpeningService.saveAndUpdateOfferTermMaster(termMasterDTO);</span>
<span class="nc bnc" id="L399" title="All 2 branches missed.">            String message = (termMasterDTO.getId() != null) ? &quot;OFFER TERM MASTER UPDATE SUCCESS&quot; : &quot;OFFER TERM MASTER CREATE SUCCESS&quot;;</span>
<span class="nc" id="L400">            ApiResponse&lt;OfferTermMaster&gt; response = new ApiResponse&lt;&gt;(offerTermMaster, true, message, &quot;INFORMATION&quot;);</span>
<span class="nc" id="L401">            return ResponseEntity.status(HttpStatus.OK).body(response);</span>
<span class="nc" id="L402">        } catch (ValidationException e) {</span>
<span class="nc" id="L403">            log.error(&quot;ValidationException: {}&quot;, e.getMessage());</span>
<span class="nc" id="L404">            ApiResponse&lt;OfferTermMaster&gt; response = new ApiResponse&lt;&gt;(null, false, &quot;OFFER TERM MASTER CREATE FAILURE&quot;, &quot;ERROR&quot;, Collections.singletonList(e.getMessage()));</span>
<span class="nc" id="L405">            return ResponseEntity.status(HttpStatus.OK).body(response);</span>
<span class="nc" id="L406">        } catch (Exception e) {</span>
<span class="nc" id="L407">            log.error(&quot;Exception: {}&quot;, e.getMessage());</span>
<span class="nc" id="L408">            ApiResponse&lt;OfferTermMaster&gt; response = new ApiResponse&lt;&gt;(null, false, &quot;OFFER TERM MASTER CREATE FAILURE&quot;, &quot;ERROR&quot;, Collections.singletonList(e.getMessage()));</span>
<span class="nc" id="L409">            return ResponseEntity.status(HttpStatus.OK).body(response);</span>
        }
    }

    @GetMapping(&quot;/findAllOfferTermMaster&quot;)
    public ResponseEntity&lt;ApiResponse&lt;Map&lt;String, Object&gt;&gt;&gt; getAllOfferTermMaster(
            @RequestParam(defaultValue = &quot;1&quot;) int page,
            @RequestParam(defaultValue = &quot;10&quot;) int size,
            @RequestParam(value = &quot;sortBy&quot;, defaultValue = &quot;createdDate&quot;, required = false) String sortBy,
            @RequestParam(value = &quot;sortDir&quot;, defaultValue = &quot;desc&quot;, required = false) String sortDir,
            @RequestParam(value = &quot;searchKeyword&quot;, required = false) String searchKeyword,
            @RequestParam(value = &quot;searchField&quot;, required = false) String searchField
    ) {
        try {
<span class="nc" id="L423">            Pageable pageable = PageRequest.of(page - 1, size, Sort.Direction.fromString(sortDir), sortBy);</span>
<span class="nc" id="L424">            Map&lt;String, Object&gt; allOfferTermMaster = jobOpeningService.getAllOfferTermMaster(searchField, searchKeyword, pageable);</span>

<span class="nc" id="L426">            ApiResponse&lt;Map&lt;String, Object&gt;&gt; response = new ApiResponse&lt;&gt;(</span>
                    allOfferTermMaster,
                    true,
                    &quot;OFFER-TERM-MASTER-DATA-RETRIEVE-SUCCESS&quot;,
                    &quot;Information&quot;
            );
<span class="nc" id="L432">            return ResponseEntity.ok(response);</span>
<span class="nc" id="L433">        } catch (Exception e) {</span>
            // Return error response
<span class="nc" id="L435">            ApiResponse&lt;Map&lt;String, Object&gt;&gt; errorResponse = new ApiResponse&lt;&gt;(</span>
                    null,
                    false,
                    &quot;OFFER-TERM-MASTER-DATA-RETRIEVE-FAILURE&quot;,
                    &quot;Error&quot;,
<span class="nc" id="L440">                    Collections.singletonList(e.getMessage())</span>
            );
<span class="nc" id="L442">            return ResponseEntity.status(HttpStatus.OK).body(errorResponse);</span>
        }
    }

    @GetMapping(&quot;job-requisitions/findAll&quot;)
    public ResponseEntity&lt;ApiResponse&lt;Map&lt;String, Object&gt;&gt;&gt; getAllJobRequisitions(
            @RequestParam(defaultValue = &quot;1&quot;) int page,
            @RequestParam(defaultValue = &quot;10&quot;) int size,
            @RequestParam(value = &quot;sortBy&quot;, defaultValue = &quot;id&quot;, required = false) String sortBy,
            @RequestParam(value = &quot;sortDir&quot;, defaultValue = &quot;desc&quot;, required = false) String sortDir,
            @RequestParam(value = &quot;searchColumn&quot;, required = false) String searchColumn,
            @RequestParam(value = &quot;searchValue&quot;, required = false) String searchValue
    ) {
        try {
<span class="nc" id="L456">            Pageable pageable = PageRequest.of(page - 1, size, Sort.Direction.fromString(sortDir), sortBy);</span>
<span class="nc" id="L457">            Map&lt;String, Object&gt; departments = jobRequisitionService.getAllJobRequisitions(pageable, searchColumn, searchValue);</span>
<span class="nc" id="L458">            ApiResponse&lt;Map&lt;String, Object&gt;&gt; response = new ApiResponse&lt;&gt;(</span>
                    departments,
                    true,
                    &quot;STAFF-LIST-SUCCESS&quot;,
                    &quot;Success&quot;
            );
<span class="nc" id="L464">            return ResponseEntity.status(HttpStatus.OK).body(response);</span>
<span class="nc" id="L465">        } catch (Exception e) {</span>
<span class="nc" id="L466">            log.error(&quot;Error occurred while fetching Departments&quot;, e);</span>
<span class="nc" id="L467">            return new ResponseEntity&lt;&gt;(</span>
                    new ApiResponse&lt;&gt;(null, false, &quot;ATMCMN-DEPARTMENT_FETCH_ERROR&quot;, &quot;FAILURE&quot;,
<span class="nc" id="L469">                            Collections.singletonList(e.getMessage())),</span>
                    HttpStatus.INTERNAL_SERVER_ERROR);
        }

    }

    @PostMapping(&quot;job-requisitions/create-update&quot;)
    public ResponseEntity&lt;ApiResponse&lt;JobRequisitionDTO&gt;&gt; createJobRequisition(
            @Validated @RequestBody JobRequisitionDTO jobRequisitionDTO) throws ParseException {
        try {
<span class="nc" id="L479">            JobRequisitionDTO createdJobRequisition = jobRequisitionService.createUpdateJobRequisition(jobRequisitionDTO);</span>

<span class="nc" id="L481">            return new ResponseEntity&lt;&gt;(</span>
                    new ApiResponse&lt;&gt;(createdJobRequisition, true, &quot;ATMCMN-DEPARTMENT_CREATED&quot;, &quot;SUCCESS&quot;),
                    HttpStatus.CREATED);
<span class="nc" id="L484">        } catch (Exception e) {</span>
<span class="nc" id="L485">            log.error(&quot;Error occurred while creating Department&quot;, e);</span>
<span class="nc" id="L486">            return new ResponseEntity&lt;&gt;(</span>
                    new ApiResponse&lt;&gt;(null, false, &quot;ATMCMN-DEPARTMENT_CREATE_ERROR&quot;, &quot;FAILURE&quot;,
<span class="nc" id="L488">                            Collections.singletonList(e.getMessage())),</span>
                    HttpStatus.INTERNAL_SERVER_ERROR);
        }
    }

    @GetMapping(&quot;job-requisitions/{id}&quot;)
    public ResponseEntity&lt;ApiResponse&lt;JobRequisitionDTO&gt;&gt; getJobRequisitionById(@PathVariable Integer id) {
        try {
<span class="nc" id="L496">            return jobRequisitionService.getJobRequisitionById(id)</span>
<span class="nc" id="L497">                    .map(dept -&gt; ResponseEntity.ok(new ApiResponse&lt;&gt;(dept, true, &quot;ATMCMN-DEPARTMENT_FETCHED&quot;, &quot;SUCCESS&quot;)))</span>
<span class="nc" id="L498">                    .orElse(new ResponseEntity&lt;&gt;(</span>
                            new ApiResponse&lt;&gt;(null, false, &quot;ATMCMN-DEPARTMENT_NOT_FOUND&quot;, &quot;FAILURE&quot;,
<span class="nc" id="L500">                                    Collections.singletonList(&quot;Department not found with ID: &quot; + id)),</span>
                            HttpStatus.NOT_FOUND));
<span class="nc" id="L502">        } catch (Exception e) {</span>
<span class="nc" id="L503">            log.error(&quot;Error occurred while fetching Department by ID&quot;, e);</span>
<span class="nc" id="L504">            return new ResponseEntity&lt;&gt;(</span>
                    new ApiResponse&lt;&gt;(null, false, &quot;ATMCMN-DEPARTMENT_FETCH_ERROR&quot;, &quot;FAILURE&quot;,
<span class="nc" id="L506">                            Collections.singletonList(e.getMessage())),</span>
                    HttpStatus.INTERNAL_SERVER_ERROR);
        }
    }

    @GetMapping(&quot;nonAssociateJobRequisitions&quot;)
    public ResponseEntity&lt;ApiResponse&lt;List&lt;JobRequisitionDTO&gt;&gt;&gt; getNonAssociateJobRequisitions() {
        try {
<span class="nc" id="L514">            List&lt;JobRequisitionDTO&gt; jobRequisitionDTOS = jobRequisitionService.getNonAssociateJobRequisitions();</span>
<span class="nc" id="L515">            return ResponseEntity.ok(</span>
                    new ApiResponse&lt;&gt;(jobRequisitionDTOS, true, &quot;JOB_REQUISITIONS_DETAILS_FETCHED&quot;, &quot;SUCCESS&quot;));
<span class="nc" id="L517">        } catch (Exception e) {</span>
<span class="nc" id="L518">            log.error(&quot;Error occurred while fetching Job Requisitions details&quot;, e);</span>
<span class="nc" id="L519">            return new ResponseEntity&lt;&gt;(</span>
                    new ApiResponse&lt;&gt;(null, false, &quot;JOB_REQUISITIONS_DETAILS_FETCH_ERROR&quot;, &quot;FAILURE&quot;,
<span class="nc" id="L521">                            Collections.singletonList(e.getMessage())),</span>
                    HttpStatus.OK);
        }
    }

    @GetMapping(&quot;offer-term-master/{id}&quot;)
    public ResponseEntity&lt;ApiResponse&lt;OfferTermMasterDTO&gt;&gt; getOfferTermMasterById(@PathVariable Long id) {
        try {
<span class="nc" id="L529">            OfferTermMasterDTO result = jobOpeningService.getOfferTermMasterById(id);</span>
<span class="nc" id="L530">            ApiResponse&lt;OfferTermMasterDTO&gt; response = new ApiResponse&lt;&gt;(result, true, &quot;OFFER-TERM-MASTER-DATA-RETRIEVE-SUCCESS&quot;, &quot;SUCCESS&quot;</span>
            );
<span class="nc" id="L532">            return ResponseEntity.status(HttpStatus.OK).body(response);</span>
<span class="nc" id="L533">        } catch (Exception e) {</span>
<span class="nc" id="L534">            log.error(&quot;Error occurred while fetching Department by ID&quot;, e);</span>
<span class="nc" id="L535">            return new ResponseEntity&lt;&gt;(</span>
                    new ApiResponse&lt;&gt;(null, false, &quot;OFFER-TERM-MASTER-DATA-RETRIEVE-FAILURE&quot;, &quot;ERROR&quot;,
<span class="nc" id="L537">                            Collections.singletonList(e.getMessage())),</span>
                    HttpStatus.OK);
        }
    }

    @GetMapping(&quot;getStaffPlanByDesignationId/{id}&quot;)
    public ResponseEntity&lt;ApiResponse&lt;List&lt;Map&lt;String, Object&gt;&gt;&gt;&gt; getStaffPlanByDesignationId(@PathVariable Integer id) {
        try {
<span class="nc" id="L545">            List&lt;Map&lt;String, Object&gt;&gt; staffPlanByDesignationId = staffPlanService.getStaffPlanByDesignationId(id);</span>
<span class="nc" id="L546">            return ResponseEntity.ok(new ApiResponse&lt;&gt;(staffPlanByDesignationId, true, &quot;STAFF_PLAN_BY_DESIGNATION&quot;, &quot;SUCCESS&quot;));</span>
<span class="nc" id="L547">        } catch (Exception e) {</span>
<span class="nc" id="L548">            return ResponseEntity.status(HttpStatus.OK).body(new ApiResponse&lt;&gt;(null, false, &quot;FETCH_ERROR&quot;, &quot;ERROR&quot;, Collections.singletonList(e.getMessage())));</span>
        }
    }

    @GetMapping(&quot;nonAssociateJobOffers&quot;)
    public ResponseEntity&lt;ApiResponse&lt;List&lt;JobOfferDTO&gt;&gt;&gt; getNonAssociateJobOffers() {
        try {
<span class="nc" id="L555">            List&lt;JobOfferDTO&gt; jobOfferDTOs = jobOpeningService.getNonAssociateJobOffers();</span>
<span class="nc bnc" id="L556" title="All 2 branches missed.">            if (jobOfferDTOs.isEmpty()) {</span>
<span class="nc" id="L557">                return new ResponseEntity&lt;&gt;(</span>
                        new ApiResponse&lt;&gt;(null, false, &quot;JOB_OFFERS_NOT_FOUND&quot;, &quot;FAILURE&quot;,
<span class="nc" id="L559">                                Collections.singletonList(&quot;No Applicant details found.&quot;)),</span>
                        HttpStatus.OK);
            }
<span class="nc" id="L562">            return ResponseEntity.ok(</span>
                    new ApiResponse&lt;&gt;(jobOfferDTOs, true, &quot;JOB_OFFERS_DETAILS_FETCHED&quot;, &quot;SUCCESS&quot;));
<span class="nc" id="L564">        } catch (Exception e) {</span>
<span class="nc" id="L565">            log.error(&quot;Error occurred while fetching Job offers details&quot;, e);</span>
<span class="nc" id="L566">            return new ResponseEntity&lt;&gt;(</span>
                    new ApiResponse&lt;&gt;(null, false, &quot;JOB_OFFERS_DETAILS_FETCH_ERROR&quot;, &quot;FAILURE&quot;,
<span class="nc" id="L568">                            Collections.singletonList(e.getMessage())),</span>
                    HttpStatus.OK);
        }
    }

    @GetMapping(&quot;/jobRequisitionDropdownList&quot;)
    public ResponseEntity&lt;ApiResponse&lt;Object&gt;&gt; jobRequisitionDropdownList() {
        try {
<span class="nc" id="L576">            List&lt;Map&lt;String, Object&gt;&gt; jobRequisitionDropdownList = jobRequisitionService.jobRequisitionDropdownList();</span>
<span class="nc" id="L577">            return ResponseEntity.ok(new ApiResponse&lt;&gt;(jobRequisitionDropdownList, true, &quot;JOB_REQUISITION_LIST_FETCHED_SUCCESS&quot;, &quot;SUCCESS&quot;));</span>
<span class="nc" id="L578">        } catch (Exception e) {</span>
<span class="nc" id="L579">            return new ResponseEntity&lt;&gt;(new ApiResponse&lt;&gt;(null, false, &quot;JOB_REQUISITION_LIST_FETCHED_ERROR&quot;, &quot;ERROR&quot;, Collections.singletonList(e.getMessage())), HttpStatus.OK);</span>
        }
    }

    @GetMapping(&quot;/jobOpeningDropdownList&quot;)
    public ResponseEntity&lt;ApiResponse&lt;Object&gt;&gt; jobOpeningDropdownList() {
        try {
<span class="nc" id="L586">            List&lt;Map&lt;String, Object&gt;&gt; jobOpeningDropdownList = jobOpeningService.jobOpeningDropdownList();</span>
<span class="nc" id="L587">            return ResponseEntity.ok(new ApiResponse&lt;&gt;(jobOpeningDropdownList, true, &quot;JOB_OPENING_LIST_FETCHED_SUCCESS&quot;, &quot;SUCCESS&quot;));</span>
<span class="nc" id="L588">        } catch (Exception e) {</span>
<span class="nc" id="L589">            return new ResponseEntity&lt;&gt;(new ApiResponse&lt;&gt;(null, false, &quot;JOB_OPENING_LIST_FETCHED_ERROR&quot;, &quot;ERROR&quot;, Collections.singletonList(e.getMessage())), HttpStatus.OK);</span>
        }
    }

    @GetMapping(&quot;/jobOfferDropdownList&quot;)
    public ResponseEntity&lt;ApiResponse&lt;Object&gt;&gt; jobOfferDropdownList() {
        try {
<span class="nc" id="L596">            List&lt;Map&lt;String, Object&gt;&gt; jobOfferDropdownList = jobOpeningService.jobOfferDropdownList();</span>
<span class="nc" id="L597">            return ResponseEntity.ok(new ApiResponse&lt;&gt;(jobOfferDropdownList, true, &quot;JOB_OFFER_LIST_FETCHED_SUCCESS&quot;, &quot;SUCCESS&quot;));</span>
<span class="nc" id="L598">        } catch (Exception e) {</span>
<span class="nc" id="L599">            return new ResponseEntity&lt;&gt;(new ApiResponse&lt;&gt;(null, false, &quot;JOB_OFFER_LIST_FETCHED_ERROR&quot;, &quot;ERROR&quot;, Collections.singletonList(e.getMessage())), HttpStatus.OK);</span>
        }
    }

    @GetMapping(&quot;/offerTermsMasterDropdownList&quot;)
    public ResponseEntity&lt;ApiResponse&lt;Object&gt;&gt; offerTermsMasterDropdownList() {
        try {
<span class="nc" id="L606">            List&lt;Map&lt;String, Object&gt;&gt; offerTermsMasterDropdownList = jobOpeningService.offerTermsMasterDropdownList();</span>
<span class="nc" id="L607">            return ResponseEntity.ok(new ApiResponse&lt;&gt;(offerTermsMasterDropdownList, true, &quot;OFFER_TERMS_MASTER_LIST_FETCHED_SUCCESS&quot;, &quot;SUCCESS&quot;));</span>
<span class="nc" id="L608">        } catch (Exception e) {</span>
<span class="nc" id="L609">            return new ResponseEntity&lt;&gt;(new ApiResponse&lt;&gt;(null, false, &quot;OFFER_TERMS_MASTER_LIST_FETCHED_ERROR&quot;, &quot;ERROR&quot;, Collections.singletonList(e.getMessage())), HttpStatus.OK);</span>
        }
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.8.202204050719</span></div></body></html>